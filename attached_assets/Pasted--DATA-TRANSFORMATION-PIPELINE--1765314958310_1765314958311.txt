                      DATA TRANSFORMATION PIPELINE                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌────────┐ │
│  │  Source  │───>│  Schema  │───>│  Field   │───>│  Enrich  │───>│ Dedupe │ │
│  │  Parse   │    │ Validate │    │ Mapping  │    │  & Calc  │    │ Check  │ │
│  └──────────┘    └──────────┘    └──────────┘    └──────────┘    └────────┘ │
│       │              │               │               │               │      │
│       ▼              ▼               ▼               ▼               ▼      │
│   Raw JSON      Zod Schema     Transformed      Computed        Final      │
│   or CSV        Validation     Record           Fields          Record      │
│                                                                              │
│  ────────────────────────────────────────────────────────────────────────── │
│                                     │                                        │
│                                     ▼                                        │
│                            ┌──────────────┐                                  │
│                            │   Staging    │                                  │
│                            │    Table     │                                  │
│                            └──────────────┘                                  │
│                                     │                                        │
│                          Commit ────┴──── Rollback                          │
│                            │                   │                             │
│                            ▼                   ▼                             │
│                    ┌──────────────┐    ┌──────────────┐                     │
│                    │   Target     │    │   Delete     │                     │
│                    │   Table      │    │   Records    │                     │
│                    └──────────────┘    └──────────────┘                     │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘